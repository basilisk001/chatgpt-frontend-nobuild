<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Essential Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO Meta Tags -->
    <title>Professional Chat Application</title>
    <meta name="description" content="A modern, responsive chat application with real-time messaging capabilities.">
    <meta name="keywords" content="chat, messaging, communication, web app">
    <meta name="author" content="Your Company Name">
    
    <!-- Open Graph Meta Tags (Social Media) -->
    <meta property="og:title" content="Professional Chat Application">
    <meta property="og:description" content="A modern, responsive chat application with real-time messaging capabilities.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourwebsite.com">
    <meta property="og:image" content="https://yourwebsite.com/og-image.jpg">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Professional Chat Application">
    <meta name="twitter:description" content="A modern, responsive chat application with real-time messaging capabilities.">
    <meta name="twitter:image" content="https://yourwebsite.com/twitter-image.jpg">
    
    <!-- Favicon and App Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Theme Color for Mobile Browsers -->
    <meta name="theme-color" content="#007bff">
    <meta name="msapplication-TileColor" content="#007bff">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/marked/marked.min.js" as="script">
    
    <!-- DNS Prefetch for External Resources -->
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    
    <!-- Critical CSS (Inline for performance) -->
    <style>
        /* Critical path CSS for initial render */
        *,*::before,*::after{box-sizing:border-box}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;margin:0;padding:0;display:flex;justify-content:center;min-height:100vh;background-color:#fff;color:#333}
        #appContainer{display:flex;flex-direction:column;width:100%;max-width:768px;min-height:100vh;margin:0 auto;box-shadow:0 10px 15px -3px rgba(0,0,0,0.1)}
        .loading{display:flex;align-items:center;justify-content:center;height:100vh;font-size:1.2rem;color:#6c757d}
    </style>
    
    <!-- Main Stylesheet -->
    <link rel="stylesheet" type="text/css" href="styles.css">
    
    <!-- Progressive Web App Configuration -->
    <meta name="application-name" content="Chat App">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Chat App">
    
    <!-- Security Headers (Content Security Policy) -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:;">
    
    <!-- Performance Hints -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Professional Chat Application",
        "description": "A modern, responsive chat application with real-time messaging capabilities.",
        "url": "https://yourwebsite.com",
        "applicationCategory": "CommunicationApplication",
        "operatingSystem": "Web Browser"
    }
    </script>
</head>

<body>
    <!-- Skip Navigation for Accessibility -->
    <a href="#main-content" class="sr-only">Skip to main content</a>
    
    <!-- Loading State -->
    <div id="loading-screen" class="loading" aria-live="polite">
        <div>Loading application...</div>
    </div>
    
    <!-- Main Application Container -->
    <div id="appContainer" style="display: none;" role="main" aria-label="Chat Application">
        <!-- Messages Display Area -->
        <messages-area 
            id="main-content" 
            role="log" 
            aria-live="polite" 
            aria-label="Chat messages">
        </messages-area>
        
        <!-- Message Input Component -->
        <message-input 
            role="region" 
            aria-label="Message input area">
        </message-input>
    </div>
    
    <!-- Additional Content Container -->
    <div id="content" role="complementary" aria-hidden="true"></div>
    
    <!-- Error Boundary -->
    <div id="error-container" style="display: none;" role="alert" aria-live="assertive">
        <div class="error-message">
            <h2>Something went wrong</h2>
            <p>Please refresh the page or try again later.</p>
            <button onclick="window.location.reload()">Refresh Page</button>
        </div>
    </div>
    
    <!-- Scripts with Error Handling and Performance Optimization -->
    <script>
        // Global error handler
        window.addEventListener('error', function(event) {
            console.error('Global error:', event.error);
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('error-container').style.display = 'flex';
        });
        
        // Performance monitoring
        if ('performance' in window) {
            window.addEventListener('load', function() {
                setTimeout(function() {
                    const perfData = performance.getEntriesByType('navigation')[0];
                    console.log('Page load time:', perfData.loadEventEnd - perfData.loadEventStart, 'ms');
                }, 0);
            });
        }
        
        // Application initialization
        function initializeApp() {
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('appContainer').style.display = 'flex';
            
            // Focus management for accessibility
            const messagesArea = document.querySelector('messages-area');
            if (messagesArea) {
                messagesArea.setAttribute('tabindex', '-1');
            }
        }
        
        // Service Worker registration (for PWA capabilities)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
    
    <!-- External Dependencies -->
    <script 
        src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" 
        defer
        crossorigin="anonymous"
        integrity="sha384-..." 
        onerror="console.error('Failed to load marked.js')">
    </script>
    
    <!-- Application Scripts -->
    <script src="messageInput.js" defer onerror="console.error('Failed to load messageInput.js')"></script>
    <script src="messagesArea.js" defer onerror="console.error('Failed to load messagesArea.js')"></script>
    <script src="controller.js" defer onerror="console.error('Failed to load controller.js'); initializeApp();"></script>
    
    <!-- Analytics (Example - Replace with your analytics code) -->
    <script>
        // Example Google Analytics 4
        // (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        // (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        // m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        // })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        // ga('create', 'UA-XXXXXXXX-X', 'auto');
        // ga('send', 'pageview');
    </script>
    
    <!-- Structured Data for Rich Snippets -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Chat Application",
        "operatingSystem": "Web",
        "applicationCategory": "CommunicationApplication",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
</body>
</html>
